### RPC远程方法调用

​		什么是RPC呢？百度百科给出的解释是这样的：“RPC（Remote Procedure Call Protocol）——远程过程调用协议，它是一种通过网络从远程计算机程序上请求服务，而不需要了解底层网络技术的协议”。

#### 1.REST 与 RPC

​		在 OpenStack 里的进程间通信方式主要有两种，一种是基于HTTP协议的RESTFul API方式，另一种则是RPC调用。那么这两种方式在应用场景上有何区别呢？有使用经验的人，就会知道：

-   前者（RESTful）主要**用于各组件之间的通信**（如nova与glance的通信），或者说用于组件对外提供调用接口。
-   后者（RPC）则用于同一组件中**各个不同模块之间的通信**（如nova组件中nova-compute与nova-scheduler的通信）

##### 1、RPC 和 REST 区别是什么？

​		首先，第一个问题：RPC 和 REST 区别是什么？

​		你一定会觉得这个问题很奇怪，是的，包括我，但是你在网络上一搜，会发现类似对比的文章比比皆是，我在想可能很多初学者由于基础不牢固，才会将不相干的二者拿出来对比吧。既然是这样，那为了让你更加了解陌生的RPC，就从你熟悉得不能再熟悉的 REST 入手吧。

###### **1、所属类别不同**

​		REST，是**Representational State Transfer** 的简写，**中文描述表述性状态传递**（是指某个瞬间状态的资源数据的快照，包括资源数据的内容、表述格式(XML、JSON)等信息。）

​		REST 是一种**软件架构风格**。这种风格的典型应用，就是**HTTP**。其因为简单、扩展性强的特点而广受开发者的青睐。

​		而RPC 呢，是 Remote Procedure Call Protocol 的简写，中文描述是**远程过程调用**，它可以实现客户端像调用本地服务(方法)一样调用服务器的服务(方法)。

​		而 RPC 可以**基于 TCP/UDP**，也可以**基于 HTTP 协议**进行传输的，按理说它和REST不是一个层面意义上的东西，不应该放在一起讨论，但是谁让REST这么流行呢，它是目前最流行的一套**互联网应用程序的API设计标准**，某种意义下，我们说 REST 可以**其实就是指代 HTTP 协议**。

###### **2、使用方式不同**

​		从使用上来看，HTTP 接口只**关注服务提供方**，对于客户端怎么调用并不关心。接口只要保证有客户端调用时，返回对应的数据就行了。而RPC则要求客户端接口保持和服务端的一致。

​		REST 是服务端**把方法写好**，客户端并不知道具体方法。客户端**只想获取资源**，所以发起HTTP请求，而服务端接收到请求后**根据URI经过一系列的路由才定位到方法**上面去

​		RPC是服务端**提供好方法给客户端调用**，客户端**需要知道服务端的具体类**，具体方法，然后像**调用本地方法一样直接调用它**。

###### **3、面向对象不同**

​		从设计上来看，RPC，所谓的远程过程调用 ，是**面向方法的** ，REST：所谓的 Representational state transfer ，是面向资源的，除此之外，还有一种叫做 SOA，所谓的**面向服务的架构**，它是面向消息的，这个接触不多，就不多说了。

###### **4、序列化协议不同**

​		接口调用通常包含两个部分，**序列化**和**通信协议**。

​		通信协议，上面已经提及了，REST 是 基于 HTTP 协议，而 RPC 可以**基于 TCP/UDP**，也可以**基于 HTTP 协议**进行传输的。

​		常见的序列化协议，有：json、xml、hession、protobuf、thrift、text、bytes等

-   REST 通常使用的是 **JSON或者XML**
-   RPC 使用的是 **JSON-RPC**，或者 **XML-RPC**

​       通过以上几点，我们知道了 REST 和 RPC 之间有很明显的差异。



##### 2、为什么要采用RPC？

​		那到底为何要使用 RPC，单纯的依靠RESTful API不可以吗？为什么要搞这么多复杂的协议，渣渣表示真的学不过来了。关于这一点，以下几点仅是我的个人猜想，仅供交流哈：

-   RPC 和 REST 两者的**定位不同**，REST 面向**资源**，更注重接口的**规范**，因为要保证通用性更强，所以对外最好通过 REST。而 RPC 面向方法，主要用于函数方法的调用，可以适合**更复杂通信需求**的场景。
    -   RESTful API客户端与服务端之间采用的是**同步机制**，当发送HTTP请求时，客户端需要**等待服务端的响应**。当然对于这一点是可以通过一些技术来**实现异步的机制**的。采用RESTful API，客户端与服务端之间虽然可以独立开发，但还是**存在耦合**。比如，客户端在发送请求的时，必须知道服务器的地址，且必须保证服务器正常工作
    -   而 rpc + ralbbimq中间件可以实现**低耦合**的**分布式集群架构**。说了这么多，我们该如何选择这两者呢？我总结了如下两点，供你参考：
-   REST 接口更加规范，通用**适配性要求高**，建议**对外的接口都统一成 REST**。而组件内部的**各个模块**，可以选择 RPC，一个是**不用耗费太多精力去开发和维护多套的HTTP接口**，另一个RPC的**调用性能更高**
    -   从性能角度看，由于HTTP本身提供了**丰富的状态功能与扩展功能**，但也正由于HTTP提供的功能过多，导致在网络传输时，需要携带的信息更多，从性能角度上讲，**较为低效**。
    -   RPC服务网络传输上**仅传输与业务内容相关的数据**，传输数据更小，**性能更高**。



##### 